<html>
<head>
<title>소녀전선 - 군수</title>
<script>
var data = [ ["0-1", 40, "00:50",   50,    0,  145, 145,   0, 0, 0, 1, 1, 0],
             ["0-2", 45, "03:00",  180,  550,    0,   0, 350, 1, 0, 0, 0, 0],
             ["0-3", 45, "12:00",  720,  900,  900, 900, 250, 0, 1, 0, 1, 0],
             ["0-4", 50, "24:00", 1440,    0, 1200, 800, 750, 0, 0, 0, 0, 1],
             ["1-1",  1, "00:15",   15,   10,   30,  15,   0, 0, 0, 0, 0, 0],
             ["1-2",  3, "00:30",   30,    0,   40,  60,   0, 0, 0, 0, 0, 0],
             ["1-3",  5, "01:00",   60,   30,    0,  30,  10, 0, 0, 0, 1, 0],
             ["1-4",  6, "02:00",  120,  160,  160,   0,   0, 1, 0, 0, 0, 0],
             ["2-1",  5, "00:40",   40,  100,    0,   0,  30, 0, 0, 0, 0, 0],
             ["2-2",  8, "01:30",   90,   60,  200,  80,   0, 0, 0, 0, 1, 0],
             ["2-3", 10, "04:00",  240,   10,   10,  10, 230, 0, 0, 1, 1, 0],
             ["2-4", 15, "06:00",  360,    0,  250, 600,  60, 1, 0, 0, 0, 0],
             ["3-1", 12, "00:20",   20,   50,    0,  75,   0, 0, 0, 0, 0, 0],
             ["3-2", 20, "00:45",   45,    0,  120,  70,  30, 0, 0, 0, 0, 0],
             ["3-3", 15, "01:30",   90,    0,  300,   0,   0, 0, 0, 1, 1, 0],
             ["3-4", 25, "05:00",  300,    0,    0, 300, 300, 1, 1, 0, 0, 0],
             ["4-1", 30, "01:00",   60,    0,  185, 185,   0, 0, 1, 0, 0, 0],
             ["4-2", 35, "02:00",  120,    0,    0,   0, 210, 0, 0, 1, 0, 0],
             ["4-3", 40, "06:00",  360,  800,  550,   0,   0, 1, 0, 0, 1, 0],
             ["4-4", 40, "08:00",  480,  400,  400, 400, 150, 0, 0, 1, 0, 0],
             ["5-1", 30, "00:30",   30,    0,    0, 100,  45, 0, 0, 0, 0, 0],
             ["5-2", 35, "02:30",  150,    0,  600, 300,   0, 0, 0, 0, 1, 0],
             ["5-3", 40, "04:00",  240,  800,  400, 400,   0, 0, 1, 0, 0, 0],
             ["5-4", 40, "07:00",  420,  100,    0,   0, 700, 1, 0, 0, 0, 0],
             ["6-1", 35, "02:00",  120,  300,  300,   0, 100, 0, 0, 0, 0, 0],
             ["6-2", 40, "03:00",  180,    0,  200, 550, 100, 0, 0, 1, 1, 0],
             ["6-3", 45, "05:00",  300,    0,    0, 200, 500, 0, 1, 0, 0, 0],
             ["6-4", 45, "12:00",  720,  800,  800, 800,   0, 0, 0, 0, 0, 1],
             ["7-1", 40, "02:30",  150,  650,    0, 650,   0, 0, 0, 0, 0, 0],
             ["7-2", 45, "04:00",  240,    0,  650,   0, 300, 1, 0, 0, 1, 0],
             ["7-3", 50, "05:30",  330,  900,  600, 600,   0, 0, 1, 0, 0, 0],
             ["7-4", 50, "08:00",  480,  250,  250, 250, 600, 0, 0, 1, 0, 0],
             ["8-1", 45, "01:00",   60,  150,  150, 150,   0, 0, 1, 0, 0, 0],
             ["8-2", 50, "03:00",  180,    0,    0,   0, 450, 0, 0, 0, 1, 0],
             ["8-3", 55, "06:00",  360,  400,  800, 800,   0, 0, 0, 1, 1, 0],
             ["8-4", 60, "09:00",  540, 1500,  400, 400, 100, 1, 0, 0, 0, 0] ];
var colInfo = [ [ 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0 ],
                [ 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1 ] ];
function init()
{
	var table = document.getElementById("logi");
	for (var i = 0; i < data.length; i++)
	{
		var tr = document.createElement("tr");
		tr.setAttribute("bgcolor", "white");
		
		for (var j = 0; j < colInfo[0].length; j++)
		{
			var td = document.createElement("td");
			
			if (colInfo[0][j] == 0)
				td.setAttribute("align", "center");
			else
				td.setAttribute("align", "right");
			
			if (3 <= j && j <= 7)
				td.setAttribute("hidden", true);
			
			if (j < 8)
			{
				td.innerText = data[i][j];
			}
			else if (j < 12)
			{
				td.innerText = Math.round(data[i][j - 4] * 60 / data[i][3]);
			}
			else if (j < 13)
			{
				td.innerText = "";
			}
			else if (j < 14)
			{
				var check = document.createElement("input");
				check.setAttribute("type", "checkbox");
				check.onclick = function() { setCheck(); };
				td.appendChild(check);
			}
			else
			{
				if (data[i][j - 6] == 0)
					td.innerText = "";
				else
					td.innerText = "○";
			}
			
			tr.appendChild(td);
		}
		
		table.appendChild(tr);
	}
	
	var url = document.location.href;
	var param1 = url.split("?");
	if (param1.length == 2)
	{
		var param2 = param1[1].split("&");
		for (var i = 0; i < param2.length; i++)
		{
			var param3 = param2[i].split("=");
			
			if (param3[0] == "w")
			{
				var param4 = param3[1].split(",");
				if (param4.length == 4)
				{
					document.getElementById("w1").value = param4[0];
					document.getElementById("w2").value = param4[1];
					document.getElementById("w3").value = param4[2];
					document.getElementById("w4").value = param4[3];
				}
			}
			else if (param3[0] == "c")
			{
				var c = param3[1].split(",");
				var table = document.getElementById("logi");
				var rows = table.getElementsByTagName("TR");
				for (var i = 1; i < rows.length; i++)
					for (var j = 0; j < c.length; j++)
						if (rows[i].getElementsByTagName("TD")[0].innerHTML == c[j])
							rows[i].getElementsByTagName("TD")[13].getElementsByTagName("input")[0].checked = true;
			}
		}
	}
	
	setCheck();
	setWeight();
	setUrl();
}

function setWeight()
{
	var w1 = document.getElementById("w1").value;
	var w2 = document.getElementById("w2").value;
	var w3 = document.getElementById("w3").value;
	var w4 = document.getElementById("w4").value;

	if (w1 == "")
	{
		document.getElementById("w1").value = "0";
		w1 = "0";
	}

	if (w2 == "")
	{
		document.getElementById("w2").value = "0";
		w2 = "0";
	}

	if (w3 == "")
	{
		document.getElementById("w3").value = "0";
		w3 = "0";
	}

	if (w4 == "")
	{
		document.getElementById("w4").value = "0";
		w4 = "0";
	}
	
	var table = document.getElementById("logi");
	for (var i = 1; i < table.rows.length; i++)
	{
		var time = table.rows[i].cells[3].innerHTML;
		var e1 = table.rows[i].cells[4].innerHTML;
		var e2 = table.rows[i].cells[5].innerHTML;
		var e3 = table.rows[i].cells[6].innerHTML;
		var e4 = table.rows[i].cells[7].innerHTML;
	
		table.rows[i].cells[12].innerHTML = Math.round((e1 * w1 + e2 * w2 + e3 * w3 + e4 * w4) * 60 / time); 
	}
	
	setUrl();
}

function setCheck()
{
	var s1 = 0;
	var s2 = 0;
	var s3 = 0;
	var s4 = 0;
	
	var table = document.getElementById("logi");
	var rows = table.getElementsByTagName("TR");
	for (var i = 1; i < rows.length; i++)
	{
		var chk = rows[i].getElementsByTagName("TD")[13].getElementsByTagName("input")[0];
		if (chk.checked)
		{
			s1 += Number(rows[i].getElementsByTagName("TD")[8].innerHTML);
			s2 += Number(rows[i].getElementsByTagName("TD")[9].innerHTML);
			s3 += Number(rows[i].getElementsByTagName("TD")[10].innerHTML);
			s4 += Number(rows[i].getElementsByTagName("TD")[11].innerHTML);
			rows[i].setAttribute("bgcolor", "yellow");
		}
		else
		{
			rows[i].setAttribute("bgcolor", "white");
		}
	}
	
	document.getElementById("s1").value = s1;
	document.getElementById("s2").value = s2;
	document.getElementById("s3").value = s3;
	document.getElementById("s4").value = s4;
	
	setUrl();
}

function uncheck()
{
	var table = document.getElementById("logi");
	var check = table.getElementsByTagName("input");
	for (var i = 1; i < check.length; i++)
		check[i].checked = false;
		
	setCheck();
}

function sortTable(col)
{
	var table = document.getElementById("logi");
	var rows = table.getElementsByTagName("TR");
	
	var dir = "desc";
	for (var i = 1; i < rows.length - 1; i++)
	{
		var x_check = rows[i].getElementsByTagName("TD")[13].getElementsByTagName("input")[0];
		var y_check = rows[i + 1].getElementsByTagName("TD")[13].getElementsByTagName("input")[0];
		
		if (!x_check.checked && y_check.checked)
		{
			dir = "asc";
			break;
		}
		
		if (x_check.checked && !y_check.checked)
		{
			continue;
		}
		
		var x = rows[i].getElementsByTagName("TD")[col].innerHTML;
		var y = rows[i + 1].getElementsByTagName("TD")[col].innerHTML;
	
		if (colInfo[0][col] == 1)
		{
			x = Number(x);
			y = Number(y);
		}
		
		if (x_check.check == y_check.check)
		{
			if (colInfo[1][col] == 0 && x > y || colInfo[1][col] == 1 && x < y)
			{
				dir = "asc";
				break;
			}
		}	
	}
	
	while(true)
	{
		var needContinue = false;
		
		for (var i = 1; i < rows.length - 1; i++)
		{
			var x_check = rows[i].getElementsByTagName("TD")[13].getElementsByTagName("input")[0];
			var y_check = rows[i + 1].getElementsByTagName("TD")[13].getElementsByTagName("input")[0];
		
			if (!x_check.checked && y_check.checked)
			{
				rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
				needContinue = true;
				continue;
			}
			
			if (x_check.checked && !y_check.checked)
			{
				continue;
			}
		
			var x = rows[i].getElementsByTagName("TD")[col].innerHTML;
			var y = rows[i + 1].getElementsByTagName("TD")[col].innerHTML;
		
			if (colInfo[0][col] == 1)
			{
				x = Number(x);
				y = Number(y);
			}
			
			var reverse = false;
			
			if (colInfo[1][col] == 1)
				reverse = !reverse;
			
			if (dir == "desc")
				reverse = !reverse;
			
			if (!reverse && x > y || reverse && x < y)
			{
				rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
				needContinue = true;
				continue;
			}
		}
		
		if (!needContinue)
			break;
	}
}

function setUrl()
{
	var url = document.location.href;
	url = url.split("?")[0];
	
	url += "?w";
	url += "=" + document.getElementById("w1").value;
	url += "," + document.getElementById("w2").value;
	url += "," + document.getElementById("w3").value;
	url += "," + document.getElementById("w4").value;
	
	var param = "";
	var table = document.getElementById("logi");
	var rows = table.getElementsByTagName("TR");
	for (var i = 1; i < rows.length; i++)
		if(rows[i].getElementsByTagName("TD")[13].getElementsByTagName("input")[0].checked)
			param += "," + rows[i].getElementsByTagName("TD")[0].innerHTML;
			
	if (param != "")
		url += "&c=" + param.substring(1, param.length);
	
	document.getElementById("url").value = url;
}
</script>
</head>
<body onload="init()">
- url
<input id="url" type="text" size="24">
<input id="url_move" type="button" value="이동" onclick='location.href = document.getElementById("url").value'><br>
- 가중치
인력<input id="w1" type="text" size="4" value="1">
탄약<input id="w2" type="text" size="4" value="1">
식량<input id="w3" type="text" size="4" value="1">
부품<input id="w4" type="text" size="4" value="1">
<input type="button" value="적용" onclick="setWeight()"><br>
- 합계　
인력<input id="s1" type="text" size="4" value="0" readonly>
탄약<input id="s2" type="text" size="4" value="0" readonly>
식량<input id="s3" type="text" size="4" value="0" readonly>
부품<input id="s4" type="text" size="4" value="0" readonly><br>
<br>
<table id="logi" cellpadding="5" cellspacing="0" border="1" style="border-collapse:collapse; border:1px gray solid;">
<tr>
<th onclick="sortTable(0)">군수</th>
<th onclick="sortTable(1)">레벨</th>
<th onclick="sortTable(2)">시간</th>
<th style="display:none;"></th>
<th style="display:none;"></th>
<th style="display:none;"></th>
<th style="display:none;"></th>
<th style="display:none;"></th>
<th onclick="sortTable(8)">인력/h</th>
<th onclick="sortTable(9)">탄약/h</th>
<th onclick="sortTable(10)">식량/h</th>
<th onclick="sortTable(11)">부품/h</th>
<th onclick="sortTable(12)">가중치</th>
<th onclick="uncheck()"><input type="checkbox" onclick="return false;"></th>
<th onclick="sortTable(14)">인형<br>제조</th>
<th onclick="sortTable(15)">장비<br>제조</th>
<th onclick="sortTable(16)">쾌속<br>제조</th>
<th onclick="sortTable(17)">쾌속<br>수복</th>
<th onclick="sortTable(18)">코인</th>
</tr>
</table>
</body>
</html>